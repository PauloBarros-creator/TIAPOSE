# feriados-nacionais
  # fonte: https://www.anbima.com.br/feriados/fer_nacionais/2019.asp
# 0: não é feriado
# 1: feriado ou véspera de feriado

#lista_feriados_2019 <- c("2019-03-03", "2019-03-04", "2019-03-05", "2019-04-18", "2019-04-19", "2019-04-20", "2019-04-21", "2019-04-30", "2019-05-01", "2019-06-19", "2019-06-20", "2019-09-06", "2019-09-07", "2019-10-11", "2019-10-12", "2019-11-01", "2019-11-02", "2019-11-14", "2019-11-15", "2019-12-24", "2019-12-25")
#lista_feriados_2020 <- c("2019-12-31", "2020-01-01", "2020-03-03", "2020-03-04", "2020-03-05", "2020-04-18", "2020-04-19", "2020-04-20", "2020-04-21", "2020-04-30", "2020-05-01", "2020-06-19", "2020-06-20", "2020-09-06", "2020-09-07", "2020-10-11", "2020-10-12", "2020-11-01", "2020-11-02", "2020-11-14", "2020-11-15", "2020-12-24", "2020-12-25")

lista_feriados <- c("2019-03-03", "2019-03-04", "2019-03-05", "2019-04-18", "2019-04-19", "2019-04-20", "2019-04-21", "2019-04-30", "2019-05-01", "2019-06-19", "2019-06-20", "2019-09-06", "2019-09-07", "2019-10-11", "2019-10-12", "2019-11-01", "2019-11-02", "2019-11-14", "2019-11-15", "2019-12-24", "2019-12-25", "2019-12-31", "2020-01-01", "2020-03-03", "2020-03-04", "2020-03-05", "2020-04-18", "2020-04-19", "2020-04-20", "2020-04-21", "2020-04-30", "2020-05-01", "2020-06-19", "2020-06-20", "2020-09-06", "2020-09-07", "2020-10-11", "2020-10-12", "2020-11-01", "2020-11-02", "2020-11-14", "2020-11-15", "2020-12-24", "2020-12-25")
lista_feriados <- as.Date(lista_feriados)

db_copia <- db

#db_copia$feriado <- db_copia$DATA %in% lista_feriados

db_copia$is_feriado <- ifelse(db_copia$DATA %in% lista_feriados, 1, 0)
db_copia$is_feriado <- as.binary(db_copia$is_feriado)
# check: db_copia[db_copia$is_feriado == '1',]

# create a vector of festival dates
festivals <- c("2019-03-01", "2019-03-02", "2019-03-03", "2019-03-04", 
               "2019-04-19", "2019-04-20", "2019-04-21", "2019-04-26", 
               "2019-04-27", "2019-04-28", "2019-05-03", "2019-05-04", 
               "2019-05-05", "2019-06-07", "2019-06-08", "2019-06-09",
               "2019-09-27", "2019-09-28", "2019-09-29", "2019-10-11", 
               "2019-10-12", "2019-10-13", "2020-02-21", "2020-02-22", 
               "2020-02-23", "2020-02-24", "2020-02-25", "2020-02-26", 
               "2020-02-27", "2020-02-28", "2020-02-29", "2020-03-01", 
               "2020-03-13", "2020-03-14", "2020-03-15", "2020-03-21", 
               "2020-03-22", "2020-03-28", "2020-03-29", "2020-04-04", 
               "2020-04-05", "2020-04-10", "2020-04-11", "2020-04-12")

# add a new column to your dataframe
df$has_festival <- as.numeric(df$date %in% festivals)
